<html lang="en" data-bs-theme="dark"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Login - ZAIDAN FITNESS RECORD</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
      :root {
        color-scheme: dark;
      }
      body {
        margin: 0;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: radial-gradient(
            circle at top right,
            rgba(37, 205, 90, 0.3),
            transparent 40%
          ),
          radial-gradient(
            circle at 20% 20%,
            rgba(56, 189, 248, 0.35),
            transparent 30%
          ),
          linear-gradient(135deg, #020617, #050f27 60%, #020617);
        font-family: "Inter", "Segoe UI", system-ui, -apple-system, sans-serif;
        color: #f8fafc;
      }
      .login-shell {
        width: min(460px, 92vw);
        padding: 2.5rem;
        border-radius: 32px;
        background: rgba(2, 6, 23, 0.72);
        border: 1px solid rgba(255, 255, 255, 0.08);
        box-shadow: 0 25px 55px rgba(2, 6, 23, 0.65);
        backdrop-filter: blur(28px) saturate(140%);
      }
      .brand-mark {
        font-size: 1.35rem;
        font-weight: 700;
        letter-spacing: 0.4px;
        background: linear-gradient(120deg, #22c55e, #86efac);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }
      .form-label {
        color: rgba(241, 245, 249, 0.85);
        font-weight: 600;
      }
      .form-control,
      .btn-custom {
        border-radius: 14px;
        font-size: 0.95rem;
      }
      .form-control {
        background: rgba(15, 23, 42, 0.75);
        border: 1px solid rgba(148, 163, 184, 0.35);
        color: #f8fafc;
      }
      .form-control:focus {
        border-color: #22c55e;
        box-shadow: 0 0 0 0.2rem rgba(34, 197, 94, 0.15);
      }
      .btn-custom {
        background: linear-gradient(135deg, #16a34a, #22c55e);
        border: none;
        color: #fff;
        font-weight: 600;
        box-shadow: 0 15px 25px rgba(34, 197, 94, 0.35);
      }
      .btn-google {
        border-radius: 14px;
        border: 1px solid rgba(148, 163, 184, 0.4);
        background: rgba(15, 23, 42, 0.65);
        color: #f8fafc;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.65rem;
        justify-content: center;
      }
      .btn-google img {
        width: 20px;
      }
      .divider {
        display: flex;
        align-items: center;
        gap: 0.85rem;
        text-transform: uppercase;
        font-size: 0.7rem;
        letter-spacing: 0.35rem;
        color: rgba(148, 163, 184, 0.75);
      }
      .divider::before,
      .divider::after {
        content: "";
        flex: 1;
        height: 1px;
        border-top: 1px solid rgba(148, 163, 184, 0.35);
      }
      .muted-note {
        color: rgba(148, 163, 184, 0.9);
        font-size: 0.85rem;
      }
      .onboarding-card {
        margin-top: 1.5rem;
        padding: 1.25rem;
        border-radius: 22px;
        background: rgba(15, 23, 42, 0.85);
        border: 1px solid rgba(148, 163, 184, 0.18);
      }
      .onboarding-card h5 {
        color: #e2e8f0;
        font-size: 1rem;
      }
    </style>
  </head>
  <body>
    <div class="login-shell">
      <div class="text-center mb-4">
        <div class="brand-mark">ZAIDAN FITNESS RECORD</div>
        <p class="muted-note">Modern POS + Member Suite</p>
      </div>
      <div id="onboarding" class="onboarding-card" style="display: none">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <h5 class="mb-0">Quick Setup</h5>
          <button class="btn btn-sm btn-outline-secondary" onclick="skipOnboarding()">
            Skip
          </button>
        </div>
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">Gym Name</label>
            <input id="ob_gym_name" class="form-control" placeholder="Your Gym Name">
          </div>
          <div class="col-md-6">
            <label class="form-label">Purpose</label>
            <input id="ob_purpose" class="form-control" placeholder="e.g., Fitness training">
          </div>
          <div class="col-md-4">
            <label class="form-label">Currency</label>
            <select id="ob_currency" class="form-select">
              <option>USD</option>
              <option>PKR</option>
              <option>INR</option>
              <option>EUR</option>
              <option>GBP</option>
              <option>AED</option>
              <option>SAR</option>
            </select>
          </div>
          <div class="col-md-4">
            <label class="form-label">Monthly Price</label>
            <input id="ob_price" type="number" min="0" step="0.01" class="form-control" value="8">
          </div>
          <div class="col-md-4">
            <label class="form-label">Logo (optional)</label>
            <input id="ob_logo" type="file" accept="image/*" class="form-control">
          </div>
          <div class="col-12">
            <label class="form-label">Features</label>
            <div class="d-flex flex-wrap gap-3 small">
              <label><input type="checkbox" class="form-check-input me-1" value="members" checked="">
                Members</label>
              <label><input type="checkbox" class="form-check-input me-1" value="fees" checked="">
                Fees</label>
              <label><input type="checkbox" class="form-check-input me-1" value="whatsapp">
                WhatsApp</label>
              <label><input type="checkbox" class="form-check-input me-1" value="backup">
                Backup</label>
            </div>
          </div>
        </div>
        <div class="mt-3 d-flex gap-2">
          <button class="btn btn-custom flex-grow-1" onclick="saveOnboarding()">
            Save &amp; Continue
          </button>
          <button class="btn btn-outline-light" onclick="skipOnboarding()">
            Skip for now
          </button>
        </div>
      </div>
        
      <form method="post" class="d-flex flex-column gap-3">
        <div>
          <label class="form-label" for="username">Username</label>
          <input class="form-control form-control-lg" name="username" id="username" required="">
        </div>
        <div>
          <label class="form-label" for="password">Password</label>
          <input class="form-control form-control-lg" name="password" id="password" type="password" required="">
        </div>
        <button class="btn btn-custom btn-lg mt-2" type="submit">
          Sign in
        </button>
      </form>
      <div class="divider my-4">or</div>
      
      <div class="alert alert-secondary py-2 text-center small mb-0">
        Configure <strong>GOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRET</strong> to enable
        Google sign-in.
      </div>
      
      <p class="muted-note text-center mt-3 mb-0">
        Need an account? <a class="link-light" href="/register">Create one</a>
      </p>
    </div>
    <script>
      async function loadOnboarding() {
        try {
          const r = await fetch('/onboarding/status');
          const j = await r.json();
          if (j.needed) {
            document.getElementById('onboarding').style.display = '';
            document.getElementById('ob_gym_name').value = j.settings.gym_name || '';
            document.getElementById('ob_purpose').value = j.settings.gym_purpose || '';
            document.getElementById('ob_currency').value = j.settings.currency_code || 'USD';
            document.getElementById('ob_price').value = j.settings.monthly_price || '8';
          }
        } catch (err) {}
      }
      async function saveOnboarding() {
        const name = document.getElementById('ob_gym_name').value.trim();
        const purpose = document.getElementById('ob_purpose').value.trim();
        const currency = document.getElementById('ob_currency').value;
        const price = document.getElementById('ob_price').value;
        const checks = Array.from(document.querySelectorAll('#onboarding input[type=checkbox]:checked')).map((x) => x.value);
        const logoInput = document.getElementById('ob_logo');
        const file = logoInput.files && logoInput.files[0];
        if (file) {
          const fd = new FormData();
          fd.append('logo', file);
          await fetch('/onboarding/logo', { method: 'POST', body: fd });
        }
        await fetch('/onboarding/complete', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            gym_name: name,
            gym_purpose: purpose,
            currency_code: currency,
            monthly_price: price,
            features: checks,
          }),
        });
        location.reload();
      }
      async function skipOnboarding() {
        await fetch('/onboarding/complete', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ skip: true }),
        });
        location.reload();
      }
      loadOnboarding();
      
    </script>
  
</body></html>